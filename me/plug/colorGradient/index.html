<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>无标题文档</title>
<style>
html,body { font-size:90%; font-family:georgia; color: #333; }
h1, h2, h3 { font-family: Microsoft YaHei; }
body { background:#EEE; }
h1 { font-size:4em; text-align:center; }
.box { width:250px; height:250px; margin:0 auto; }
</style>
<script src="av.js"></script>
</head>
<body>
<div class="wrap">
    <h1>JavaScript颜色渐变效果演示</h1>
    <div class="box" id="box"></div>
</div>
<script>
function fadeColors(from, to, callback, duration, framesPerSecond) {
    function doTimeout(color, frame) {
        setTimeout(function() {
            try {
                callback(color)
            } catch(e) {
                av.log.write(e);
            }
        }, (duration * 1000 / framesPerSecond) * frame)
    }
    var duration = duration || 1;
    var framesPerSecond = framesPerSecond || duration * 15;
    var r, g, b;
    var frame = 1;
    //设置第0帧渐变的开始色
    doTimeout('rgb(' + from.r + ',' + from.g + ',' + from.b + ')', 0);
    while(frame < framesPerSecond + 1) {
        r = Math.ceil(from.r * ((framesPerSecond - frame) / framesPerSecond) + to.r * (frame / framesPerSecond));
        g = Math.ceil(from.g * ((framesPerSecond - frame) / framesPerSecond) + to.g * (frame / framesPerSecond));
        b = Math.ceil(from.b * ((framesPerSecond - frame) / framesPerSecond) + to.b * (frame / framesPerSecond));
        doTimeout('rgb(' + r + ',' + g + ',' + b + ')', frame);
        frame++;
    }
}
//对box应用样式,3S后完成渐变
var obj = document.getElementById("box");
fadeColors(
    {r:255,g:187,b:2},
    {r:1,g:121,b:255},
    function(color) {
        av.setStyle(obj,{"background-color":color})
    },
    3
)
</script>
</body>
</html>